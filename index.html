<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>Block Blast Benzeri Oyun</title>
<style>
  body {
    background: #222;
    color: white;
    font-family: monospace;
    text-align: center;
    margin: 0; padding: 0;
  }
  #scoreboard {
    position: fixed;
    top: 5px;
    left: 5px;
    font-size: 18px;
  }
  #game {
    margin: 40px auto;
    display: grid;
    grid-template-columns: repeat(8, 50px);
    grid-template-rows: repeat(8, 50px);
    gap: 3px;
    width: max-content;
  }
  .block {
    width: 50px;
    height: 50px;
    border-radius: 6px;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }
</style>
</head>
<body>
<h1>Block Blast Benzeri Oyun</h1>
<div id="scoreboard">Skor: 0</div>
<div id="game"></div>

<script>
const colors = ['#e74c3c', '#3498db', '#2ecc71', '#f1c40f', '#9b59b6', '#e67e22'];
const rows = 8;
const cols = 8;
let score = 0;

const gameEl = document.getElementById('game');
const scoreEl = document.getElementById('scoreboard');

// Oyun tahtasını 2D dizi olarak tutacağız, her hücrede renk indeksi var
let board = [];

function randomColorIndex() {
  return Math.floor(Math.random() * colors.length);
}

// Tahtayı doldur
function initBoard() {
  board = [];
  for(let r=0; r<rows; r++) {
    const row = [];
    for(let c=0; c<cols; c++) {
      row.push(randomColorIndex());
    }
    board.push(row);
  }
}

// Tahtayı ekrana çiz
function drawBoard() {
  gameEl.innerHTML = '';
  for(let r=0; r<rows; r++) {
    for(let c=0; c<cols; c++) {
      const block = document.createElement('div');
      block.classList.add('block');
      block.style.backgroundColor = colors[board[r][c]];
      block.dataset.r = r;
      block.dataset.c = c;
      block.addEventListener('click', () => onBlockClick(r, c));
      gameEl.appendChild(block);
    }
  }
}

// Yan yana aynı renkte blokları bul ve patlat
function onBlockClick(r, c) {
  const colorIndex = board[r][c];
  const toRemove = [];
  const visited = Array.from({length: rows}, () => Array(cols).fill(false));

  function dfs(rr, cc) {
    if(rr < 0 || rr >= rows || cc < 0 || cc >= cols) return;
    if(visited[rr][cc]) return;
    if(board[rr][cc] !== colorIndex) return;
    visited[rr][cc] = true;
    toRemove.push([rr, cc]);
    dfs(rr-1, cc);
    dfs(rr+1, cc);
    dfs(rr, cc-1);
    dfs(rr, cc+1);
  }

  dfs(r,c);

  if(toRemove.length < 3) {
    // 3 bloktan azsa patlatma
    alert('En az 3 aynı renkte blok seçmelisin!');
    return;
  }

  // Patlat
  for(const [rr, cc] of toRemove) {
    board[rr][cc] = null; // boş
  }

  score += toRemove.length * 10;
  scoreEl.textContent = 'Skor: ' + score;

  gravity();
  refill();
  drawBoard();
}

// Blokların aşağı kaymasını sağlar
function gravity() {
  for(let c=0; c<cols; c++) {
    for(let r=rows-1; r>=0; r--) {
      if(board[r][c] === null) {
        // Yukarıdan boşluk doldur
        for(let rr = r - 1; rr >= 0; rr--) {
          if(board[rr][c] !== null) {
            board[r][c] = board[rr][c];
            board[rr][c] = null;
            break;
          }
        }
      }
    }
  }
}

// Boş kalanları rastgele yeni blokla doldur
function refill() {
  for(let r=0; r<rows; r++) {
    for(let c=0; c<cols; c++) {
      if(board[r][c] === null) {
        board[r][c] = randomColorIndex();
      }
    }
  }
}

initBoard();
drawBoard();

</script>
</body>
</html>
